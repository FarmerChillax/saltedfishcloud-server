(function(e,t){typeof exports=="object"&&typeof module!="undefined"?t(require("vue"),require("sfc-common")):typeof define=="function"&&define.amd?define(["vue","sfc-common"],t):(e=typeof globalThis!="undefined"?globalThis:e||self,t(e.Vue,e.SfcCommon))})(this,function(e,t){"use strict";var te=Object.defineProperty,oe=Object.defineProperties;var ne=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var D=(e,t,a)=>t in e?te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,N=(e,t)=>{for(var a in t||(t={}))le.call(t,a)&&D(e,a,t[a]);if(B)for(var a of B(t))re.call(t,a)&&D(e,a,t[a]);return e},k=(e,t)=>oe(e,ne(t));const a="/webShell";var E;(r=>{function i(c,p){return t.useJsonBody({url:`${a}/executeCommand`,method:"post",params:{nodeId:p},data:c})}r.sendSimpleCommand=i})(E||(E={}));var ae="",de="",se="",T=(r,i)=>{const c=r.__vccOpts||r;for(const[p,x]of i)c[p]=x;return c};const h=r=>(e.pushScopeId("data-v-6cf1813f"),r=r(),e.popScopeId(),r),U={class:"d-flex align-center"},I=h(()=>e.createElementVNode("br",null,null,-1)),$=h(()=>e.createElementVNode("p",{class:"text-header text-primary"}," \u9644\u52A0\u53C2\u6570 ",-1)),L={class:"other-param"},W=h(()=>e.createElementVNode("p",{class:"text-header text-primary",style:{"margin-bottom":"18px"}}," \u73AF\u5883\u53D8\u91CF ",-1)),M=h(()=>e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null," Name "),e.createElementVNode("th",{style:{"min-width":"120px"}}," Value "),e.createElementVNode("th",{style:{width:"81px"}})])],-1)),H={style:{"max-width":"92px"}},P=["onUpdate:modelValue"],j=["onUpdate:modelValue"],q=e.defineComponent({name:"WsSimpleExecView",components:{FormSelect:t.Components.FormSelect,ClusterSelector:t.Components.ClusterSelector}}),O=e.defineComponent(k(N({},q),{setup(r){const i=[{title:"UTF-8",value:"utf8"},{title:"GBK",value:"gbk"}],c=e.ref(),p=window.SfcUtils,x=new t.LoadingManager,g=x.getLoadingRef(),_=e.ref(""),y=e.ref(""),C=e.ref(!1),f=e.ref([{name:"",value:""}]),l=e.reactive({charset:"utf8",cmd:"",env:{},timeout:10}),u=[];let m=0;const b=t.MethodInterceptor.createAsyncActionProxy({async send(){if(!g.value){if(l.cmd.length==0)return Promise.reject("\u547D\u4EE4\u4E0D\u80FD\u4E3A\u7A7A");try{u.unshift(l.cmd),u.length>=500&&u.pop(),_.value+=`SHELL> ${l.cmd}
`,l.env={},f.value.filter(s=>s.name.length>0).forEach(s=>{l.env[s.name]=s.value});const d=await p.request(E.sendSimpleCommand(l,C.value?y.value:null));_.value+=`${d.data.data.output}
\u6267\u884C\u8017\u65F6: ${d.data.data.time}ms \u7A0B\u5E8F\u9000\u51FA\u7801: ${d.data.data.exitCode}
`,await e.nextTick();const o=c.value.$el;o.scrollTop=o.scrollHeight,l.cmd=""}catch(d){return _.value+=`
\u6267\u884C\u51FA\u9519: `+d+`
`,Promise.reject(d)}}}},!1,x),G=d=>{const o=d.code=="ArrowUp",s=d.code=="ArrowDown";if(!o&&!s){m=0;return}if(!!u.length){if(s&&m--,m>=u.length||m<0){s&&(l.cmd="",m=0);return}l.cmd=u[m],o&&m++}};return(d,o)=>{const s=e.resolveComponent("LoadingMask"),J=e.resolveComponent("SimpleTextarea"),z=e.resolveComponent("TextInput"),w=e.resolveComponent("CommonIcon"),Q=e.resolveComponent("VCheckbox"),X=e.resolveComponent("ClusterSelector"),Y=e.resolveComponent("FormSelect"),Z=e.resolveComponent("VTextField"),v=e.resolveComponent("VTable"),ee=e.resolveDirective("ripple");return e.openBlock(),e.createElementBlock("div",null,[e.createVNode(s,{loading:e.unref(g)},null,8,["loading"]),e.createVNode(J,{ref_key:"outputRef",ref:c,modelValue:_.value,"onUpdate:modelValue":o[0]||(o[0]=n=>_.value=n),readonly:"",class:"output"},null,8,["modelValue"]),e.createElementVNode("div",U,[e.createVNode(z,{modelValue:e.unref(l).cmd,"onUpdate:modelValue":o[1]||(o[1]=n=>e.unref(l).cmd=n),label:"\u8F93\u5165\u547D\u4EE4",placeholder:"\u8F93\u5165\u547D\u4EE4\uFF0C\u56DE\u8F66\u76F4\u63A5\u6267\u884C",style:{"margin-right":"6px"},"hide-details":"",onKeydown:G,onEnter:e.unref(b).send},null,8,["modelValue","onEnter"]),e.withDirectives(e.createVNode(w,{color:"primary",style:{padding:"12px","border-radius":"50%",cursor:"pointer"},icon:"mdi-send",flat:"",onClick:e.unref(b).send},null,8,["onClick"]),[[ee]])]),I,$,e.createElementVNode("div",L,[e.createVNode(Q,{modelValue:C.value,"onUpdate:modelValue":o[2]||(o[2]=n=>C.value=n),color:"primary",label:"\u6307\u5B9A\u8282\u70B9","hide-details":""},null,8,["modelValue"]),C.value?(e.openBlock(),e.createBlock(X,{key:0,modelValue:y.value,"onUpdate:modelValue":o[3]||(o[3]=n=>y.value=n),style:{"max-width":"240px"}},null,8,["modelValue"])):e.createCommentVNode("",!0),e.createVNode(Y,{modelValue:e.unref(l).charset,"onUpdate:modelValue":o[4]||(o[4]=n=>e.unref(l).charset=n),label:"\u7A0B\u5E8F\u8F93\u51FA\u7F16\u7801",style:{"max-width":"92px"},"hide-details":"",items:i},null,8,["modelValue"]),e.createVNode(Z,{modelValue:e.unref(l).timeout,"onUpdate:modelValue":o[5]||(o[5]=n=>e.unref(l).timeout=n),class:"float-label-t6",style:{"margin-bottom":"6px"},color:"primary",variant:"underlined","hide-details":"",label:"\u6267\u884C\u8D85\u65F6(s)"},null,8,["modelValue"])]),W,e.createElementVNode("div",null,[e.createVNode(v,{style:{width:"100%","max-width":"480px"},class:"elevation-1"},{default:e.withCtx(()=>[M,e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(n,A)=>(e.openBlock(),e.createElementBlock("tr",{key:A},[e.createElementVNode("td",H,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":V=>n.name=V,class:"plain-input"},null,8,P),[[e.vModelText,n.name]])]),e.createElementVNode("td",null,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":V=>n.value=V,class:"plain-input"},null,8,j),[[e.vModelText,n.value]])]),e.createElementVNode("td",null,[e.createVNode(w,{style:{cursor:"pointer"},icon:"mdi-plus",onClick:o[6]||(o[6]=V=>e.unref(f).push({name:"",value:""}))}),e.unref(f).length!=1?(e.openBlock(),e.createBlock(w,{key:0,style:{cursor:"pointer"},icon:"mdi-delete",onClick:V=>e.unref(f).splice(A,1)},null,8,["onClick"])):e.createCommentVNode("",!0)])]))),128))])]),_:1})])])}}}));var F=T(O,[["__scopeId","data-v-6cf1813f"]]);const R=[e.createElementVNode("h1",null,"\u5F00\u53D1\u4E2D",-1)],K=e.defineComponent({name:"WsInteractiveExecView"}),S=e.defineComponent(k(N({},K),{props:{},setup(r){return(i,c)=>(e.openBlock(),e.createElementBlock("div",null,R))}}));window.bootContext.addProcessor({execute(r,i){r.component(F.name,F),r.component(S.name,S)},taskName:"\u6CE8\u518CWebShell\u7EC4\u4EF6"})});
